<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Crie um novo post no Roxe">
    <title>Novo Post - r/Roxe</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="page-header">
            <nav class="breadcrumb">
                <a href="index.html" class="breadcrumb-link">← Início</a>
                <span class="breadcrumb-separator">/</span>
                <span class="breadcrumb-current">Novo Post</span>
            </nav>
            <h1 class="page-title">Criar Novo Post</h1>
            <p class="page-subtitle">Compartilhe suas ideias na comunidade Roxe</p>
        </header>

        <main class="main-content">
            <section class="form-section">
                <form id="postForm" class="post-form">
                    <div class="form-group">
                        <label for="title" class="form-label">
                            Título do Post
                            <span class="required">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="title" 
                            name="title"
                            class="form-input"
                            placeholder="Digite um título interessante..."
                            required
                            maxlength="100"
                            aria-describedby="title-help title-error"
                        >
                        <div id="title-help" class="form-help">
                            Escolha um título claro e atrativo (máx. 100 caracteres)
                        </div>
                        <div id="title-error" class="form-error" role="alert" aria-live="polite"></div>
                        <div class="char-count">
                            <span id="titleCount">0</span>/100
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="content" class="form-label">
                            Conteúdo do Post
                            <span class="required">*</span>
                        </label>
                        <textarea 
                            id="content" 
                            name="content"
                            class="form-textarea"
                            placeholder="Escreva seu conteúdo aqui..."
                            rows="12"
                            required
                            maxlength="5000"
                            aria-describedby="content-help content-error"
                        ></textarea>
                        <div id="content-help" class="form-help">
                            Use formatação Markdown para estilizar seu texto (máx. 5000 caracteres)
                        </div>
                        <div id="content-error" class="form-error" role="alert" aria-live="polite"></div>
                        <div class="char-count">
                            <span id="contentCount">0</span>/5000
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="category" class="form-label">Categoria</label>
                        <select id="category" name="category" class="form-select">
                            <option value="">r/Roxe</option>
                            <option value="tecnologia">r/tecnologia</option>
                            <option value="design">r/design</option>
                            <option value="programacao">r/programacao</option>
                            <option value="negocios">r/negocios</option>
                            <option value="pessoal">r/pessoal</option>
                            <option value="jogos">r/jogos</option>
                            <option value="noticias">r/noticias</option>
                            <option value="memes">r/memes</option>
                            <option value="ajuda">r/ajuda</option>
                            <option value="debate">r/debate</option>
                            <option value="offtopic">r/offtopic</option>
                            <option value="arte">r/arte</option>
                            <option value="musica">r/musica</option>
                            <option value="filmes">r/filmes</option>
                            <option value="livros">r/livros</option>
                            <option value="viagens">r/viagens</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="tags" class="form-label">Tags</label>
                        <input 
                            type="text" 
                            id="tags" 
                            name="tags"
                            class="form-input"
                            placeholder="separe tags com vírgulas (ex: javascript, web, tutorial)"
                            aria-describedby="tags-help"
                        >
                        <div id="tags-help" class="form-help">
                            Adicione tags para ajudar outros a encontrar seu post
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <span class="btn-text">Publicar Post</span>
                            <span class="btn-loading" style="display: none;">
                                <span class="loading"></span>
                                Publicando...
                            </span>
                        </button>
                        
                        <button type="button" class="btn btn-secondary" onclick="saveDraft()">
                            Salvar Rascunho
                        </button>
                        
                        <a href="index.html" class="btn btn-outline">
                            Cancelar
                        </a>
                    </div>
                </form>
            </section>

            <aside class="preview-section">
                <div class="preview-header">
                    <h2>Pré-visualização</h2>
                    <button type="button" class="btn btn-sm" onclick="togglePreview()">
                        <span id="previewToggle">Ocultar</span>
                    </button>
                </div>
                <div id="preview" class="viewer">
                    <div class="viewer-content">
                        <h3 id="previewTitle" class="preview-title">Seu título aparecerá aqui</h3>
                        <div id="previewContent" class="preview-content">
                            Seu conteúdo aparecerá aqui...
                        </div>
                        <div id="previewMeta" class="preview-meta">
                            <span class="preview-category"></span>
                            <span class="preview-tags"></span>
                        </div>
                    </div>
                </div>
            </aside>
        </main>

        <footer class="page-footer">
            <div class="footer-content">
                <p>&copy; 2024 r/Roxe. Todos os direitos reservados.</p>
                <div class="footer-links">
                    <a href="#">Sobre</a>
                    <a href="#">Contato</a>
                    <a href="#">Privacidade</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modal de Sucesso -->
    <div id="successModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Post Criado com Sucesso!</h3>
                <button type="button" class="modal-close" onclick="closeModal('successModal')">&times;</button>
            </div>
            <div class="modal-body">
                <p>Seu post foi publicado e já está disponível na comunidade Roxe.</p>
            </div>
            <div class="modal-actions">
                <a href="index.html" class="btn">Ver Comunidade</a>
                <button type="button" class="btn btn-secondary" onclick="createAnother()">Criar Outro</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        // Character counting
        document.getElementById('title').addEventListener('input', function() {
            document.getElementById('titleCount').textContent = this.value.length;
            updatePreview();
        });

        document.getElementById('content').addEventListener('input', function() {
            document.getElementById('contentCount').textContent = this.value.length;
            updatePreview();
        });

        document.getElementById('category').addEventListener('change', updatePreview);
        document.getElementById('tags').addEventListener('input', updatePreview);

        // Real-time preview
        function updatePreview() {
            const title = document.getElementById('title').value || 'Seu título aparecerá aqui';
            const content = document.getElementById('content').value || 'Seu conteúdo aparecerá aqui...';
            const category = document.getElementById('category').value;
            const tags = document.getElementById('tags').value;

            document.getElementById('previewTitle').textContent = title;
            document.getElementById('previewContent').textContent = content;
            
            const categoryElement = document.querySelector('.preview-category');
            categoryElement.textContent = category ? `r/${category}` : 'r/Roxe';
            
            const tagsElement = document.querySelector('.preview-tags');
            tagsElement.textContent = tags ? `Tags: ${tags}` : '';
        }

        function togglePreview() {
            const preview = document.getElementById('preview');
            const toggle = document.getElementById('previewToggle');
            
            if (preview.style.display === 'none') {
                preview.style.display = 'block';
                toggle.textContent = 'Ocultar';
            } else {
                preview.style.display = 'none';
                toggle.textContent = 'Mostrar';
            }
        }

        // Form validation
        document.getElementById('postForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Clear previous errors
            document.querySelectorAll('.form-error').forEach(el => el.textContent = '');
            
            const title = document.getElementById('title').value.trim();
            const content = document.getElementById('content').value.trim();
            
            let hasError = false;
            
            if (title.length < 3) {
                document.getElementById('title-error').textContent = 'O título deve ter pelo menos 3 caracteres';
                hasError = true;
            }
            
            if (content.length < 10) {
                document.getElementById('content-error').textContent = 'O conteúdo deve ter pelo menos 10 caracteres';
                hasError = true;
            }
            
            if (!hasError) {
                savePost();
            }
        });

        function savePost() {
            const title = document.getElementById('title').value.trim();
            const content = document.getElementById('content').value.trim();
            const category = document.getElementById('category').value || '';
            const tagsInput = document.getElementById('tags').value.trim();
            
            const tags = tagsInput ? tagsInput.split(',').map(tag => tag.trim()).filter(tag => tag) : [];
            
            const post = createPost(title, content, category, tags);
            
            if (savePostToStorage(post)) {
                // Show success modal
                document.getElementById('successModal').style.display = 'flex';
            } else {
                alert('Erro ao salvar post. Tente novamente.');
            }
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function createAnother() {
            closeModal('successModal');
            document.getElementById('postForm').reset();
            updatePreview();
            document.getElementById('titleCount').textContent = '0';
            document.getElementById('contentCount').textContent = '0';
        }
    </script>
</body>
</html>
