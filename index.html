<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Roxe - Comunidade estilo Reddit">
    <meta name="keywords" content="f√≥rum, comunidade, discuss√£o, posts, reddit">
    <title>r/Roxe - A Melhor Comunidade</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö´</text></svg>">
</head>
<body>
    <!-- Reddit-Style Header -->
    <header class="reddit-header">
        <div class="reddit-nav">
            <div class="nav-left">
                <div class="hamburger-menu" onclick="toggleSidebar()">‚ò∞</div>
                <div class="logo-container">
                    <span class="logo">‚ö´</span>
                    <span class="logo-text">Roxe</span>
                </div>
            </div>
            
            <div class="nav-center">
                <div class="search-bar">
                    <input type="text" placeholder="Search r/Roxe" id="redditSearch">
                    <button onclick="searchPosts()">üîç</button>
                </div>
            </div>
            
            <div class="nav-right">
                <div class="user-menu">
                    <div class="user-menu-trigger" onclick="toggleUserMenu()">
                        <div class="user-avatar-small" id="userAvatarSmall">U</div>
                        <span id="userKarma">0 karma</span>
                        <span>‚ñº</span>
                    </div>
                    <div class="user-menu-dropdown" id="userMenuDropdown">
                        <button class="user-menu-item" onclick="openProfile()">üë§ Meu Perfil</button>
                        <button class="user-menu-item" onclick="openChatModal()">üí¨ Bate-Papo</button>
                        <button class="user-menu-item" onclick="openFriendsModal()">üë• Amigos</button>
                        <button class="user-menu-item" onclick="openSettings()">‚öôÔ∏è Configura√ß√µes</button>
                        <button class="user-menu-item" onclick="toggleTheme()">üåô Tema</button>
                        <button class="user-menu-item" onclick="logout()">üö™ Sair</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content - Reddit Layout -->
    <div class="reddit-layout">
        <!-- Sidebar -->
        <aside class="reddit-sidebar" id="sidebar">
            <!-- Profile Card -->
            <div class="profile-sidebar">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">U</div>
                    <div class="profile-name" id="profileName">Carregando...</div>
                    <div class="profile-username" id="profileUsername">@carregando</div>
                </div>
                
                <div class="profile-stats">
                    <div class="profile-stat">
                        <div class="profile-stat-value" id="userPosts">0</div>
                        <div class="profile-stat-label">Posts</div>
                    </div>
                    <div class="profile-stat">
                        <div class="profile-stat-value" id="userComments">0</div>
                        <div class="profile-stat-label">Comments</div>
                    </div>
                    <div class="profile-stat">
                        <div class="profile-stat-value karma-display" id="userKarmaDisplay">0</div>
                        <div class="profile-stat-label">Karma</div>
                    </div>
                </div>
                
                <div class="profile-badges" id="userBadges">
                    <!-- Badges will be added dynamically -->
                </div>
                
                <button class="btn btn-primary" onclick="openCreateModal()" style="width: 100%;">
                    ‚úèÔ∏è Criar Post
                </button>
            </div>

            <!-- Community Card -->
            <div class="community-card">
                <div class="community-header">
                    <div class="community-avatar">‚ö´</div>
                    <div class="community-info">
                        <h3>r/Roxe</h3>
                        <p>Uma comunidade para compartilhar ideias</p>
                    </div>
                </div>
                
                <div class="community-stats">
                    <span>üë• <span id="communityMembers">1</span> membros</span>
                    <span>üìä <span id="communityPosts">0</span> posts</span>
                </div>
                
                <button class="community-action" onclick="joinCommunity()">
                    Juntar-se √† Comunidade
                </button>
            </div>

            <!-- Trending Topics -->
            <div class="community-card">
                <h3>üî• T√≥picos em Alta</h3>
                <div class="trending-list" id="trendingTopics">
                    <div class="trending-item">üí¨ discuss√£o</div>
                    <div class="trending-item">‚ù§Ô∏è ajuda</div>
                    <div class="trending-item">üöÄ tecnologia</div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="reddit-main">
            <!-- Sort and Filter Bar -->
            <div class="content-header">
                <div class="sort-options">
                    <button class="sort-btn active" onclick="sortPosts('hot')">üî• Quente</button>
                    <button class="sort-btn" onclick="sortPosts('new')">‚ú® Novo</button>
                    <button class="sort-btn" onclick="sortPosts('top')">‚¨ÜÔ∏è Top</button>
                    <button class="sort-btn" onclick="sortPosts('rising')">üìà Crescente</button>
                </div>
                
                <div class="view-options">
                    <select id="categoryFilter" onchange="filterPosts()">
                        <option value="">r/Roxe</option>
                        <option value="tecnologia">r/tecnologia</option>
                        <option value="design">r/design</option>
                        <option value="programacao">r/programacao</option>
                        <option value="negocios">r/negocios</option>
                        <option value="pessoal">r/pessoal</option>
                        <option value="jogos">r/jogos</option>
                        <option value="noticias">r/noticias</option>
                        <option value="memes">r/memes</option>
                        <option value="ajuda">r/ajuda</option>
                        <option value="debate">r/debate</option>
                        <option value="offtopic">r/offtopic</option>
                        <option value="arte">r/arte</option>
                        <option value="musica">r/musica</option>
                        <option value="filmes">r/filmes</option>
                        <option value="livros">r/livros</option>
                        <option value="viagens">r/viagens</option>
                    </select>
                </div>
            </div>

            <!-- Posts Feed -->
            <div id="posts" class="reddit-posts-feed">
                <div class="loading-state" id="loadingPosts">
                    <div class="loading-spinner"></div>
                    <p>Carregando posts...</p>
                </div>
                
                <div class="empty-state" id="emptyPosts" style="display: none;">
                    <div class="empty-icon">üìù</div>
                    <h3>Nenhum post encontrado</h3>
                    <p>Seja o primeiro a compartilhar algo com a comunidade!</p>
                    <button class="btn btn-primary" onclick="openCreateModal()">
                        Criar Primeiro Post
                    </button>
                </div>
            </div>
        </main>
    </div>

    <!-- Create Post Modal -->
    <div id="createModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Criar Novo Post</h3>
                <button class="modal-close" onclick="closeCreateModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="quickCreateForm">
                    <div class="form-group">
                        <label for="quickTitle" class="form-label">T√≠tulo</label>
                        <input 
                            type="text" 
                            id="quickTitle" 
                            class="form-input"
                            placeholder="Digite um t√≠tulo interessante..."
                            required
                            maxlength="300"
                        >
                        <div class="char-count">
                            <span id="titleCount">0</span>/300
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="quickContent" class="form-label">Conte√∫do</label>
                        <textarea 
                            id="quickContent" 
                            class="form-textarea"
                            placeholder="Digite o conte√∫do do seu post..."
                            rows="8"
                            required
                            maxlength="5000"
                        ></textarea>
                        <div class="char-count">
                            <span id="contentCount">0</span>/5000
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="quickCategory" class="form-label">Comunidade</label>
                        <select id="quickCategory" class="form-select">
                            <option value="">r/Roxe</option>
                            <option value="tecnologia">r/tecnologia</option>
                            <option value="design">r/design</option>
                            <option value="programacao">r/programacao</option>
                            <option value="negocios">r/negocios</option>
                            <option value="pessoal">r/pessoal</option>
                            <option value="jogos">r/jogos</option>
                            <option value="noticias">r/noticias</option>
                            <option value="memes">r/memes</option>
                            <option value="ajuda">r/ajuda</option>
                            <option value="debate">r/debate</option>
                            <option value="offtopic">r/offtopic</option>
                            <option value="arte">r/arte</option>
                            <option value="musica">r/musica</option>
                            <option value="filmes">r/filmes</option>
                            <option value="livros">r/livros</option>
                            <option value="viagens">r/viagens</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="quickTags" class="form-label">Tags</label>
                        <input 
                            type="text" 
                            id="quickTags" 
                            class="form-input"
                            placeholder="separe tags com v√≠rgulas (ex: javascript, web, tutorial)"
                        >
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="postSpoiler"> Spoiler
                        </label>
                        <label>
                            <input type="checkbox" id="postNSFW"> NSFW
                        </label>
                    </div>
                </form>
            </div>
            <div class="modal-actions">
                <button class="btn btn-primary" onclick="quickCreatePost()">
                    Publicar
                </button>
                <button class="btn btn-outline" onclick="closeCreateModal()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- Post Viewer Modal -->
    <div id="viewer" class="modal viewer-modal" style="display: none;">
        <div class="modal-content viewer-content">
            <div class="viewer-header">
                <h2 id="viewTitle" class="viewer-title"></h2>
                <button class="modal-close" onclick="closeViewer()">&times;</button>
            </div>
            <div class="viewer-body">
                <div class="post-meta">
                    <span class="post-category" id="viewCategory"></span>
                    <span class="post-date" id="viewDate"></span>
                </div>
                <div class="post-tags" id="viewTags"></div>
                <div id="viewContent" class="post-content"></div>
            </div>
            <div class="viewer-actions">
                <button class="btn btn-secondary" onclick="editPost()">
                    ‚úèÔ∏è Editar
                </button>
                <button class="btn btn-danger" onclick="deletePost()">
                    üóëÔ∏è Excluir
                </button>
                <button class="btn btn-outline" onclick="closeViewer()">
                    Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- Friends Modal -->
    <div id="friendsModal" class="modal" style="display: none;">
        <div class="modal-content friends-modal">
            <div class="modal-header">
                <h3>üë• Amigos</h3>
                <button class="modal-close" onclick="closeFriendsModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="friends-container">
                    <div class="friends-section">
                        <h4>Adicionar Amigo</h4>
                        <div class="add-friend-form">
                            <input type="text" id="friendUsername" placeholder="Nome de usu√°rio...">
                            <button onclick="addFriend()">Adicionar</button>
                        </div>
                    </div>
                    
                    <div class="friends-section">
                        <h4>Lista de Amigos</h4>
                        <div class="friends-list" id="friendsList">
                            <!-- Friends will be added here -->
                        </div>
                    </div>
                    
                    <div class="friends-section">
                        <h4>Solicita√ß√µes Pendentes</h4>
                        <div class="friend-requests" id="friendRequests">
                            <!-- Requests will be added here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Modal -->
    <div id="chatModal" class="modal" style="display: none;">
        <div class="modal-content chat-modal">
            <div class="modal-header">
                <h3>üí¨ Bate-Papo</h3>
                <button class="modal-close" onclick="closeChatModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <!-- Messages will be added here -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Digite sua mensagem..." onkeypress="if(event.key==='Enter') sendMessage()">
                        <button onclick="sendMessage()">Enviar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast" style="display: none;">
        <div class="toast-content">
            <span id="toastMessage"></span>
            <button class="toast-close" onclick="hideToast()">&times;</button>
        </div>
    </div>

    <!-- Floating Action Button -->
    <button class="fab" onclick="openCreateModal()" title="Criar Novo Post">
        ‚úèÔ∏è
    </button>
    
    <button class="theme-toggle" onclick="toggleTheme()" title="Alternar Tema">
        üåô
    </button>

    <script src="script.js"></script>
    <script>
        // Reddit-style functionality
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show');
        }

        function toggleUserMenu() {
            const dropdown = document.getElementById('userMenuDropdown');
            dropdown.classList.toggle('show');
        }

        function openProfile() {
            showToast('Perfil em desenvolvimento! üë§', 'info');
            toggleUserMenu();
        }

        function openSettings() {
            showToast('Configura√ß√µes em desenvolvimento! ‚öôÔ∏è', 'info');
            toggleUserMenu();
        }

        function logout() {
            if (confirm('Tem certeza que deseja sair?')) {
                localStorage.removeItem('rose_forum_user');
                location.reload();
            }
            toggleUserMenu();
        }

        function joinCommunity() {
            showToast('Bem-vindo √† comunidade! üéâ', 'success');
        }

        // Update user profile display
        function updateProfileDisplay() {
            const user = getCurrentUser();
            
            // Update profile info
            document.getElementById('profileName').textContent = user.name;
            document.getElementById('profileUsername').textContent = '@' + user.name.toLowerCase().replace(/\s+/g, '');
            document.getElementById('userAvatarSmall').textContent = user.name.charAt(0).toUpperCase();
            document.getElementById('profileAvatar').textContent = user.name.charAt(0).toUpperCase();
            
            // Calculate user stats
            const posts = getAllPosts().filter(p => p.author === user.name);
            const comments = getAllComments().filter(c => c.author === user.name);
            
            let totalKarma = 0;
            posts.forEach(post => {
                totalKarma += (post.upvotes || 0) - (post.downvotes || 0);
            });
            comments.forEach(comment => {
                totalKarma += (comment.upvotes || 0) - (comment.downvotes || 0);
            });
            
            document.getElementById('userPosts').textContent = posts.length;
            document.getElementById('userComments').textContent = comments.length;
            document.getElementById('userKarmaDisplay').textContent = totalKarma;
            document.getElementById('userKarma').textContent = totalKarma + ' karma';
            
            // Add badges based on karma
            const badgesContainer = document.getElementById('userBadges');
            badgesContainer.innerHTML = '';
            
            if (totalKarma >= 1000) {
                badgesContainer.innerHTML += '<span class="badge badge-gold">üèÜ Gold</span>';
            } else if (totalKarma >= 500) {
                badgesContainer.innerHTML += '<span class="badge badge-silver">ü•à Silver</span>';
            } else if (totalKarma >= 100) {
                badgesContainer.innerHTML += '<span class="badge badge-bronze">ü•â Bronze</span>';
            }
            
            if (posts.length >= 10) {
                badgesContainer.innerHTML += '<span class="badge">üìù Postador</span>';
            }
            
            if (comments.length >= 20) {
                badgesContainer.innerHTML += '<span class="badge">üí¨ Comentador</span>';
            }
        }

        // Update community stats
        function updateCommunityStats() {
            const posts = getAllPosts();
            const users = new Set(posts.map(p => p.author));
            
            document.getElementById('communityMembers').textContent = users.size + 1; // +1 for current user
            document.getElementById('communityPosts').textContent = posts.length;
        }

        // Character counting for create form
        document.getElementById('quickTitle')?.addEventListener('input', function() {
            document.getElementById('titleCount').textContent = this.value.length;
        });

        document.getElementById('quickContent')?.addEventListener('input', function() {
            document.getElementById('contentCount').textContent = this.value.length;
        });

        // Sort posts with Reddit-style options
        function sortPosts(sortType) {
            // Update active button
            document.querySelectorAll('.sort-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            const posts = getAllPosts();
            let sorted = [...posts];
            
            switch(sortType) {
                case 'hot':
                    // Sort by score and recent activity
                    sorted.sort((a, b) => {
                        const scoreA = (a.upvotes || 0) - (a.downvotes || 0);
                        const scoreB = (b.upvotes || 0) - (b.downvotes || 0);
                        return scoreB - scoreA;
                    });
                    break;
                case 'new':
                    sorted.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'top':
                    // Sort by total score
                    sorted.sort((a, b) => {
                        const scoreA = (a.upvotes || 0) - (a.downvotes || 0);
                        const scoreB = (b.upvotes || 0) - (b.downvotes || 0);
                        return scoreB - scoreA;
                    });
                    break;
                case 'rising':
                    // Sort by upvote velocity (simplified)
                    sorted.sort((a, b) => (b.upvotes || 0) - (a.upvotes || 0));
                    break;
            }
            
            displayPosts(sorted);
        }

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.user-menu')) {
                document.getElementById('userMenuDropdown').classList.remove('show');
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            updateThemeIcon();
            loadPosts();
            updateStats();
            updateProfileDisplay();
            updateCommunityStats();
        });
    </script>
</body>
</html>
